function initSendCode(d,c,a){var b;$("#"+d).click(function(){if(b&&b.isRunning){return}var f=document.getElementById(c).value;var e;if(a){if(!f.length){mui.toast("请输入用户名");return}e=Host+"api/ValiCode/GetCodeByName?name="+f}else{if(!isTel(f)){mui.toast("手机号不正确");return}e=Host+"api/ValiCode/GetCode?phone="+f}ajaxData(e,function(h){if(a&&h.Status==200){mui.confirm("验证码已发送至"+h.Message+", 请注意查收 ~",null,["好的"])}else{if(h.Status==1){mui.toast("验证码发送成功")}else{return h.Message}}},null,function(){b.isStop=true});if(!b){var g=$(this);b=new downTimer(60,function(h){g.html("重新发送("+h+")")},function(){g.html("发送验证码")})}b.start()})}function isTel(a){return/^1[3|4|5|7|8]\d{9}$/.test(a)}function downTimer(c,b,a){this.isRunning=false;this.isStop=false;this.duration=c;this.runningCB=b;this.stopCB=a;this.start=function(){if(!this.isRunning){this.isRunning=true;this.duration=c;this.countdown()}};this.countdown=function(){var d=this;if(d.duration==0||d.isStop){d.isRunning=false;d.stopCB&&d.stopCB()}else{d.duration--;setTimeout(function(){d.countdown()},1000);d.runningCB&&d.runningCB(d.duration)}}};